<!-- residentes.page.html -->
<ion-header>
  <ion-toolbar color="mytheme">
    <ion-title>Residentes</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding" color="mytheme-2">

   <ion-card-content class="lottie-container">
      <lottie-player
        src="../../../assets/animations/register.json"
        background="transparent"
        speed="1"
        loop
        autoplay
        class="lottie-player">
      </lottie-player>
    </ion-card-content>

  <!-- üîç Buscador -->
  <ion-searchbar
    placeholder="Buscar por n√∫mero o nombre..."
    [(ngModel)]="searchTerm"
    (ionInput)="filtrarDepartamentos()"
    class="custom-search">
  </ion-searchbar>

  <!-- üìä Resumen general -->
  <ion-grid class="summary-grid">
    <ion-row>
      <ion-col size="4">
        <ion-card class="kpi-card">
          <ion-card-content class="ion-text-center">
            <ion-icon class="kpi-icon" name="home-outline"></ion-icon>
            <h2 class="kpi-value">{{ totalOcupados }}</h2>
            <p class="kpi-label">Ocupados</p>
          </ion-card-content>
        </ion-card>
      </ion-col>

      <ion-col size="4">
        <ion-card class="kpi-card">
          <ion-card-content class="ion-text-center">
            <ion-icon class="kpi-icon" name="ellipse-outline"></ion-icon>
            <h2 class="kpi-value">{{ totalVacios }}</h2>
            <p class="kpi-label">Vac√≠os</p>
          </ion-card-content>
        </ion-card>
      </ion-col>

      <ion-col size="4">
        <ion-card class="kpi-card">
          <ion-card-content class="ion-text-center">
            <ion-icon class="kpi-icon" name="alert-circle-outline"></ion-icon>
            <h2 class="kpi-value">{{ totalMorosos }}</h2>
            <p class="kpi-label">Morosos</p>
          </ion-card-content>
        </ion-card>
      </ion-col>
    </ion-row>
  </ion-grid>

  <!-- üèòÔ∏è Lista de Residentes -->
  <ion-card class="list-card">
    <ion-card-header>
      <ion-card-title>Listado de Residentes</ion-card-title>
    </ion-card-header>

    <ion-card-content>
      <ion-list class="resident-list">
        <ion-item *ngFor="let d of departamentosFiltrados" class="resident-item" lines="none">
          <ion-icon class="avatar-icon" name="person-circle-outline" slot="start"></ion-icon>

          <ion-label class="resident-label">
            <h2><strong>Dpto {{ d.numero }}</strong> ‚Äî {{ d.nombre }}</h2>
            <p>üìû {{ d.telefono }}</p>
            <p>‚úâÔ∏è {{ d.correo }}</p>
          </ion-label>

          <ion-badge
            class="status-badge"
            [ngClass]="{
              'badge-ok': d.estadoPago === 'Al d√≠a',
              'badge-warn': d.estadoPago === 'Pendiente',
              'badge-empty': d.estadoPago === 'Vac√≠o',
              'badge-bad': (d.estadoPago !== 'Al d√≠a' && d.estadoPago !== 'Pendiente' && d.estadoPago !== 'Vac√≠o')
            }">
            {{ d.estadoPago }}
          </ion-badge>
        </ion-item>
      </ion-list>
    </ion-card-content>
  </ion-card>

</ion-content>
